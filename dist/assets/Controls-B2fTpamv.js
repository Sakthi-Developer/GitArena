var K=Object.defineProperty;var J=(s,e,t)=>e in s?K(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var T=(s,e,t)=>J(s,typeof e!="symbol"?e+"":e,t);import{u as y,c as G,r as d,d as Q,e as ee,f as te,g as C,j as g,h as M,t as D,i as se,k as re,l as ne}from"./index-BbW-UkJs.js";import{g as ae,r as oe}from"./isomorphic-git-C77K5K18.js";import{g as ie}from"./levels-D9FzCBIE.js";function I(s,e,t){return Math.min(Math.max(s,e),t)}function ce(s){let e=!1,t=null;return(...r)=>{t=r,e||(e=!0,requestAnimationFrame(()=>{e=!1,t&&s(...t)}))}}function le(s){return s.slice(0,7)}const H=.1,O=3,ue=.001;function he(s){const e=y(G),t=y(o=>o.setView),r=d.useRef(!1),a=d.useRef({x:0,y:0}),n=d.useRef(ce(o=>t(o))).current,i=d.useCallback(o=>{var l;o.preventDefault();const{zoom:p,panX:b,panY:$}=y.getState().view;if(o.ctrlKey||o.metaKey){const w=-o.deltaY*ue,N=I(p*(1+w),H,O),A=(l=s.current)==null?void 0:l.getBoundingClientRect();if(A){const u=o.clientX-A.left,m=o.clientY-A.top,k=N/p,B=u-(u-b)*k,L=m-(m-$)*k;n({zoom:N,panX:B,panY:L})}else n({zoom:N})}else n({panX:b-o.deltaX,panY:$-o.deltaY})},[s,n]),h=d.useCallback(o=>{var p,b;(o.button===0||o.button===1)&&(r.current=!0,a.current={x:o.clientX,y:o.clientY},(b=(p=o.target)==null?void 0:p.setPointerCapture)==null||b.call(p,o.pointerId))},[]),c=d.useCallback(o=>{if(!r.current)return;const p=o.clientX-a.current.x,b=o.clientY-a.current.y;a.current={x:o.clientX,y:o.clientY};const{panX:$,panY:l}=y.getState().view;n({panX:$+p,panY:l+b})},[n]),f=d.useCallback(()=>{r.current=!1},[]);d.useEffect(()=>{const o=s.current;if(o)return o.addEventListener("wheel",i,{passive:!1}),o.addEventListener("pointerdown",h),o.addEventListener("pointermove",c),o.addEventListener("pointerup",f),o.addEventListener("pointerleave",f),()=>{o.removeEventListener("wheel",i),o.removeEventListener("pointerdown",h),o.removeEventListener("pointermove",c),o.removeEventListener("pointerup",f),o.removeEventListener("pointerleave",f)}},[s,i,h,c,f]);const x=d.useCallback(()=>{t({panX:0,panY:0,zoom:1})},[t]),E=d.useCallback(()=>{const{zoom:o}=y.getState().view;t({zoom:I(o*1.2,H,O)})},[t]),R=d.useCallback(()=>{const{zoom:o}=y.getState().view;t({zoom:I(o/1.2,H,O)})},[t]);return{view:e,resetView:x,zoomIn:E,zoomOut:R}}function fe(s,e,t,r,a,n,i,h,c){s.clearRect(0,0,n,i),s.save(),s.translate(t,r),s.scale(a,a);const f=a<.3||e.nodes.length>C.lodThreshold,x=f?C.nodeRadiusLOD:C.nodeRadius,E=-t/a-C.virtualizationPadding,R=-r/a-C.virtualizationPadding,o=(n-t)/a+C.virtualizationPadding,p=(i-r)/a+C.virtualizationPadding;let b;c?b=c.queryRect({x:E,y:R,width:o-E,height:p-R}):b=e.nodes.filter(l=>l.x>=E&&l.x<=o&&l.y>=R&&l.y<=p);const $=new Set(b.map(l=>l.oid));s.lineWidth=C.lineWidth,s.lineCap="round",s.lineJoin="round";for(const l of e.edges){if(!$.has(l.from)&&!$.has(l.to))continue;s.strokeStyle=l.color,s.globalAlpha=.6,s.beginPath();const w=l.points;w.length===2?(s.moveTo(w[0].x,w[0].y),s.lineTo(w[1].x,w[1].y)):w.length===4&&(s.moveTo(w[0].x,w[0].y),s.bezierCurveTo(w[1].x,w[1].y,w[2].x,w[2].y,w[3].x,w[3].y)),s.stroke()}s.globalAlpha=1;for(const l of b){const w=l.oid===h,N=l.isHead;if(s.beginPath(),s.arc(l.x,l.y,x,0,Math.PI*2),N?(s.fillStyle=l.color,s.fill(),s.shadowColor=l.color,s.shadowBlur=12,s.fill(),s.shadowBlur=0):(s.fillStyle=M.surface,s.fill(),s.strokeStyle=l.color,s.lineWidth=w?C.headHighlightWidth:C.lineWidth,s.stroke()),w&&(s.beginPath(),s.arc(l.x,l.y,x+4,0,Math.PI*2),s.strokeStyle=M.accent,s.lineWidth=2,s.setLineDash([4,4]),s.stroke(),s.setLineDash([])),!f){s.fillStyle=N?"#ffffff":M.text,s.font=`${D.weights.medium} ${C.fontSize-2}px ${D.fontMono}`,s.textAlign="center",s.textBaseline="middle",s.fillText(le(l.oid),l.x,l.y),s.fillStyle=M.textMuted,s.font=`${D.weights.normal} ${C.fontSize-1}px ${D.fontSans}`,s.textAlign="center";const A=l.message.length>30?l.message.slice(0,27)+"...":l.message;if(s.fillText(A,l.x,l.y+x+16),l.refs.length>0){let u=l.x+x+12;const m=l.y;s.textAlign="left",s.textBaseline="middle";for(const k of l.refs){const B=k;s.font=`${D.weights.semibold} ${C.fontSize-1}px ${D.fontMono}`;const L=s.measureText(B),z=C.labelPadding,P=L.width+z*2,F=20;if(s.fillStyle=l.color+"25",s.strokeStyle=l.color+"60",s.lineWidth=1,de(s,u,m-F/2,P,F,6),s.fill(),s.stroke(),s.fillStyle=l.color,s.fillText(B,u+z,m+1),l.isHead){const Z=u+P+6;s.fillStyle=M.warning,s.font=`${D.weights.bold} ${C.fontSize-2}px ${D.fontMono}`,s.fillText("HEAD",Z,m+1)}u+=P+8}}}}s.restore()}function de(s,e,t,r,a,n){s.beginPath(),s.moveTo(e+n,t),s.lineTo(e+r-n,t),s.arcTo(e+r,t,e+r,t+n,n),s.lineTo(e+r,t+a-n),s.arcTo(e+r,t+a,e+r-n,t+a,n),s.lineTo(e+n,t+a),s.arcTo(e,t+a,e,t+a-n,n),s.lineTo(e,t+n),s.arcTo(e,t,e+n,t,n),s.closePath()}const Te=d.memo(function(){const e=d.useRef(null),t=d.useRef(null),r=d.useRef(null),a=d.useRef(0),n=y(Q),i=y(G),h=y(ee),c=y(o=>o.setSelectedNode),{resetView:f,zoomIn:x,zoomOut:E}=he(e);d.useEffect(()=>{n.nodes.length>0?r.current=te(n):r.current=null},[n]),d.useEffect(()=>{const o=t.current,p=e.current;if(!o||!p)return;const b=new ResizeObserver($=>{for(const l of $){const{width:w,height:N}=l.contentRect,A=window.devicePixelRatio||1;p.width=w*A,p.height=N*A,p.style.width=`${w}px`,p.style.height=`${N}px`}});return b.observe(o),()=>b.disconnect()},[]),d.useEffect(()=>{const o=e.current;if(!o)return;const p=o.getContext("2d");if(!p)return;const b=window.devicePixelRatio||1;p.setTransform(b,0,0,b,0,0);const $=o.width/b,l=o.height/b;return cancelAnimationFrame(a.current),a.current=requestAnimationFrame(()=>{fe(p,n,i.panX,i.panY,i.zoom,$,l,h,r.current)}),()=>cancelAnimationFrame(a.current)},[n,i,h]);const R=d.useCallback(o=>{const p=e.current;if(!p||!r.current)return;const b=p.getBoundingClientRect(),{panX:$,panY:l,zoom:w}=y.getState().view,N=(o.clientX-b.left-$)/w,A=(o.clientY-b.top-l)/w,u=r.current.queryNearest(N,A,C.nodeRadius*1.5);c((u==null?void 0:u.oid)??null)},[c]);return g.jsxs("div",{ref:t,className:"relative flex-1 overflow-hidden bg-arena-bg",children:[g.jsx("canvas",{ref:e,className:"absolute inset-0 w-full h-full cursor-grab active:cursor-grabbing",onClick:R,role:"img","aria-label":"Git commit graph visualization",tabIndex:0}),g.jsxs("div",{className:"absolute bottom-3 right-3 flex flex-col gap-0.5 z-10",role:"toolbar","aria-label":"Graph zoom controls",children:[g.jsx("button",{onClick:x,className:"btn-ghost w-[36px] h-[36px] flex items-center justify-center rounded-lg bg-arena-surface border border-arena-border text-lg","aria-label":"Zoom in",children:"+"}),g.jsx("button",{onClick:E,className:"btn-ghost w-[36px] h-[36px] flex items-center justify-center rounded-lg bg-arena-surface border border-arena-border text-lg","aria-label":"Zoom out",children:"-"}),g.jsx("button",{onClick:f,className:"btn-ghost w-[36px] h-[36px] flex items-center justify-center rounded-lg bg-arena-surface border border-arena-border text-xs","aria-label":"Reset view",children:"fit"})]}),n.nodes.length===0&&g.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-arena-textDim text-sm",children:"No commits yet. Use the terminal to create commits."})]})});var me=oe();const S=ae(me);class W{constructor(){T(this,"root",{type:"dir",children:new Map})}resolve(e){return e.split("/").filter(Boolean)}getParent(e){var r;let t=this.root;for(let a=0;a<e.length-1;a++){const n=(r=t.children)==null?void 0:r.get(e[a]);if(!n||n.type!=="dir")return null;t=n}return t}mkdirp(e){let t=this.root;for(const r of e){t.children||(t.children=new Map);let a=t.children.get(r);a||(a={type:"dir",children:new Map},t.children.set(r,a)),t=a}return t}readFile(e){var a;const t=this.resolve(e);let r=this.root;for(const n of t){const i=(a=r.children)==null?void 0:a.get(n);if(!i)throw new Error(`ENOENT: ${e}`);r=i}if(r.type!=="file"||!r.content)throw new Error(`EISDIR: ${e}`);return r.content}writeFile(e,t){const r=this.resolve(e),a=this.mkdirp(r.slice(0,-1)),n=typeof t=="string"?new TextEncoder().encode(t):t;a.children||(a.children=new Map),a.children.set(r[r.length-1],{type:"file",content:n})}unlink(e){const t=this.resolve(e),r=this.getParent(t);r!=null&&r.children&&r.children.delete(t[t.length-1])}readdir(e){var a,n;const t=this.resolve(e);let r=this.root;for(const i of t){const h=(a=r.children)==null?void 0:a.get(i);if(!h||h.type!=="dir")throw new Error(`ENOENT: ${e}`);r=h}return Array.from(((n=r.children)==null?void 0:n.keys())??[])}mkdir(e){const t=this.resolve(e);this.mkdirp(t)}rmdir(e){const t=this.resolve(e),r=this.getParent(t);r!=null&&r.children&&r.children.delete(t[t.length-1])}stat(e){var a;const t=this.resolve(e);let r=this.root;if(t.length===0)return{type:"dir",isFile:()=>!1,isDirectory:()=>!0,isSymbolicLink:()=>!1};for(const n of t){const i=(a=r.children)==null?void 0:a.get(n);if(!i)throw new Error(`ENOENT: ${e}`);r=i}return{type:r.type,isFile:()=>r.type==="file",isDirectory:()=>r.type==="dir",isSymbolicLink:()=>!1}}lstat(e){return this.stat(e)}snapshot(){const e=new Map,t=(r,a)=>{if(r.type==="file"&&r.content&&e.set(a,r.content),r.children)for(const[n,i]of r.children)t(i,a?`${a}/${n}`:n)};return t(this.root,""),e}restore(e){this.root={type:"dir",children:new Map};for(const[t,r]of e)this.writeFile(t,r)}}function X(s){return{promises:{readFile:async e=>s.readFile(e),writeFile:async(e,t)=>s.writeFile(e,t),unlink:async e=>s.unlink(e),readdir:async e=>s.readdir(e),mkdir:async e=>s.mkdir(e),rmdir:async e=>s.rmdir(e),stat:async e=>s.stat(e),lstat:async e=>s.lstat(e)}}}const v="/repo";class U{constructor(){T(this,"memfs");T(this,"fs");T(this,"author",{name:"Player",email:"player@gitarena.dev"});this.memfs=new W,this.fs=X(this.memfs)}async init(){this.memfs=new W,this.fs=X(this.memfs),await S.init({fs:this.fs,dir:v,defaultBranch:"main"}),this.memfs.writeFile(`${v}/README.md`,`# GitArena
`),await S.add({fs:this.fs,dir:v,filepath:"README.md"}),await S.commit({fs:this.fs,dir:v,message:"Initial commit",author:this.author})}async commit(e){const t=`file-${Date.now()}.txt`;return this.memfs.writeFile(`${v}/${t}`,`${e}
`),await S.add({fs:this.fs,dir:v,filepath:t}),await S.commit({fs:this.fs,dir:v,message:e,author:this.author})}async branch(e){await S.branch({fs:this.fs,dir:v,ref:e})}async checkout(e){await S.checkout({fs:this.fs,dir:v,ref:e})}async currentBranch(){return await S.currentBranch({fs:this.fs,dir:v})||"HEAD"}async listBranches(){return S.listBranches({fs:this.fs,dir:v})}async deleteBranch(e){await S.deleteBranch({fs:this.fs,dir:v,ref:e})}async resolveRef(e){return S.resolveRef({fs:this.fs,dir:v,ref:e})}async log(e,t){const r=e??await this.currentBranch(),a=await S.log({fs:this.fs,dir:v,ref:r,depth:t}),n=await this.listBranches(),i=new Map;for(const c of n){const f=await S.resolveRef({fs:this.fs,dir:v,ref:c}),x=i.get(f)??[];x.push(c),i.set(f,x)}const h=await this.resolveRef("HEAD");return await this.currentBranch(),a.map(c=>({oid:c.oid,message:c.commit.message.trim(),parents:c.commit.parent,timestamp:c.commit.author.timestamp,refs:i.get(c.oid)??[],isHead:c.oid===h}))}async allCommits(){const e=await this.listBranches(),t=new Set,r=[],a=await this.resolveRef("HEAD");await this.currentBranch();const n=new Map;for(const i of e){const h=await S.resolveRef({fs:this.fs,dir:v,ref:i}),c=n.get(h)??[];c.push(i),n.set(h,c)}for(const i of e)try{const h=await S.log({fs:this.fs,dir:v,ref:i});for(const c of h){if(t.has(c.oid)){const f=r.find(x=>x.oid===c.oid);if(f){const x=n.get(c.oid)??[];for(const E of x)f.refs.includes(E)||f.refs.push(E)}continue}t.add(c.oid),r.push({oid:c.oid,message:c.commit.message.trim(),parents:c.commit.parent,timestamp:c.commit.author.timestamp,refs:n.get(c.oid)??[],isHead:c.oid===a})}}catch{}return r}async merge(e){return(await S.merge({fs:this.fs,dir:v,ours:await this.currentBranch(),theirs:e,author:this.author})).oid??""}async rebase(e){const t=await this.currentBranch(),r=await S.log({fs:this.fs,dir:v,ref:t}),a=await S.log({fs:this.fs,dir:v,ref:e}),n=new Set(a.map(f=>f.oid)),i=[];for(const f of r){if(n.has(f.oid))break;i.push(f)}i.reverse(),await this.resolveRef(e),await this.checkout(e);const h=`__rebase_${Date.now()}`;await this.branch(h),await this.checkout(h);for(const f of i)await this.commit(f.commit.message.trim());const c=await this.resolveRef("HEAD");this.memfs.writeFile(`${v}/.git/refs/heads/${t}`,c+`
`),await this.checkout(t);try{await this.deleteBranch(h)}catch{}}async resetHard(e){const t=await this.resolveRef(e),r=await this.currentBranch();this.memfs.writeFile(`${v}/.git/refs/heads/${r}`,t+`
`),await S.checkout({fs:this.fs,dir:v,ref:r,force:!0})}takeSnapshot(){return this.memfs.snapshot()}restoreSnapshot(e){this.memfs.restore(e)}}let j=null;function q(){return j||(j=new U),j}function pe(){return j=new U,j}function ge(s){const e=[];let t="",r=0;for(let a=0;a<s.length;a++){const n=s[a];switch(r){case 0:if(n===" "||n==="	")continue;n==="'"?(r=2,t=""):n==='"'?(r=3,t=""):(r=1,t=n);break;case 1:n===" "||n==="	"?(e.push(t),t="",r=0):t+=n;break;case 2:n==="'"?(e.push(t),t="",r=0):t+=n;break;case 3:n==='"'?(e.push(t),t="",r=0):t+=n;break;default:t+=n}}return t.length>0&&e.push(t),e}function we(s){const e=ge(s.trim());if(e.length===0||e[0]!=="git")return null;if(e.length<2)return{base:"git",subcommand:"",args:[],flags:{}};const t=e[1],r=[],a={},n=new Set(["b","d","D","f","v","q"]);for(let i=2;i<e.length;i++){const h=e[i];if(h.startsWith("--")){const c=h.indexOf("=");if(c>-1){let f=h.slice(c+1);(f.startsWith('"')&&f.endsWith('"')||f.startsWith("'")&&f.endsWith("'"))&&(f=f.slice(1,-1)),a[h.slice(2,c)]=f}else i+1<e.length&&!e[i+1].startsWith("-")?(a[h.slice(2)]=e[i+1],i++):a[h.slice(2)]=!0}else if(h.startsWith("-")&&h.length===2){const c=h.slice(1);n.has(c)?a[c]=!0:i+1<e.length&&!e[i+1].startsWith("-")?(a[c]=e[i+1],i++):a[c]=!0}else r.push(h)}return{base:"git",subcommand:t,args:r,flags:a}}const Y=["commit","branch","checkout","merge","rebase","reset","log","status","help"];async function V(s,e){const t=s.trim();if(!t)return{success:!0,output:"",type:"info"};if(t==="clear")return{success:!0,output:"__CLEAR__",type:"info"};if(t==="help"||t==="git help")return{success:!0,output:_(),type:"info"};const r=we(t);if(!r)return{success:!1,output:`Unknown command: "${t}". Type "help" for available commands.`,type:"error"};if(!r.subcommand)return{success:!1,output:`Usage: git <command> [args]
Type "git help" for available commands.`,type:"error"};if(!Y.includes(r.subcommand))return{success:!1,output:`git: "${r.subcommand}" is not a supported command.
Supported: ${Y.join(", ")}`,type:"error"};const a=e??q();try{switch(r.subcommand){case"commit":return await be(a,r);case"branch":return await ye(a,r);case"checkout":return await ve(a,r);case"merge":return await xe(a,r);case"rebase":return await ke(a,r);case"reset":return await Se(a,r);case"log":return await Ce(a);case"status":return await $e(a);case"help":return{success:!0,output:_(),type:"info"};default:return{success:!1,output:`Unhandled command: ${r.subcommand}`,type:"error"}}}catch(n){return{success:!1,output:`Error: ${n instanceof Error?n.message:String(n)}`,type:"error"}}}async function be(s,e){const t=e.flags.m??e.flags.message??e.args[0]??`commit ${Date.now().toString(36)}`,r=await s.commit(t);return{success:!0,output:`[${await s.currentBranch()} ${r.slice(0,7)}] ${t}`,type:"success"}}async function ye(s,e){if(e.flags.d||e.flags.D||e.flags.delete){const t=e.args[0];return t?(await s.deleteBranch(t),{success:!0,output:`Deleted branch ${t}`,type:"success"}):{success:!1,output:"Usage: git branch -d <name>",type:"error"}}if(e.args.length===0){const t=await s.listBranches(),r=await s.currentBranch();return{success:!0,output:t.map(n=>n===r?`* ${n}`:`  ${n}`).join(`
`),type:"info"}}return await s.branch(e.args[0]),{success:!0,output:`Created branch "${e.args[0]}"`,type:"success"}}async function ve(s,e){return e.flags.b&&e.args[0]?(await s.branch(e.args[0]),await s.checkout(e.args[0]),{success:!0,output:`Switched to a new branch "${e.args[0]}"`,type:"success"}):e.args.length===0?{success:!1,output:"Usage: git checkout <branch|commit>",type:"error"}:(await s.checkout(e.args[0]),{success:!0,output:`Switched to "${e.args[0]}"`,type:"success"})}async function xe(s,e){if(e.args.length===0)return{success:!1,output:"Usage: git merge <branch>",type:"error"};const t=await s.merge(e.args[0]);return{success:!0,output:`Merged "${e.args[0]}" into "${await s.currentBranch()}" â†’ ${t.slice(0,7)}`,type:"success"}}async function ke(s,e){return e.args.length===0?{success:!1,output:"Usage: git rebase <branch>",type:"error"}:(await s.rebase(e.args[0]),{success:!0,output:`Rebased "${await s.currentBranch()}" onto "${e.args[0]}"`,type:"success"})}async function Se(s,e){if(!e.flags.hard)return{success:!1,output:'Only "git reset --hard <ref>" is supported.',type:"error"};const t=e.args[0]??"HEAD~1";return await s.resetHard(t),{success:!0,output:`HEAD is now at ${t}`,type:"success"}}async function Ce(s){const e=await s.log(void 0,10);return e.length===0?{success:!0,output:"No commits yet.",type:"info"}:{success:!0,output:e.map(r=>{const a=r.refs.length>0?` (${r.refs.join(", ")})`:"",n=r.isHead?" <- HEAD":"";return`${r.oid.slice(0,7)}${a}${n} ${r.message}`}).join(`
`),type:"info"}}async function $e(s){return{success:!0,output:`On branch ${await s.currentBranch()}
nothing to commit, working tree clean`,type:"info"}}function _(){return`Available commands:
  git commit -m "<message>"    Create a new commit
  git branch [<name>]          List or create branches
  git branch -d <name>         Delete a branch
  git checkout <ref>           Switch to branch or commit
  git checkout -b <name>       Create and switch to new branch
  git merge <branch>           Merge branch into current
  git rebase <branch>          Rebase current onto branch
  git reset --hard <ref>       Reset to a specific commit
  git log                      Show commit history
  git status                   Show current branch
  help                         Show this help message
  clear                        Clear terminal`}const Re=['git commit -m ""',"git branch","git branch -d","git checkout","git checkout -b","git merge","git rebase","git reset --hard","git log","git status","help","clear"];function Ee(s){if(!s)return[];const e=s.toLowerCase();return Re.filter(t=>t.toLowerCase().startsWith(e))}const Me=d.memo(function({onCommandExecuted:e}){const t=d.useRef(null),r=d.useRef(null),[a,n]=d.useState(""),[i,h]=d.useState(-1),[c,f]=d.useState([]),[x,E]=d.useState(0),R=y(se),o=y(u=>u.addHistory),p=y(u=>u.clearHistory),b=y(u=>u.incrementCommandCount);d.useEffect(()=>{r.current&&(r.current.scrollTop=r.current.scrollHeight)},[R]);const $=d.useCallback(()=>{var u;(u=t.current)==null||u.focus()},[]),l=d.useCallback(async()=>{const u=q();try{const m=await u.allCommits(),k=await u.currentBranch(),B=await u.listBranches();y.getState().setCommits(m),y.getState().setCurrentBranch(k),y.getState().setBranches(B)}catch{}},[]),w=d.useCallback(async u=>{u.preventDefault();const m=a.trim();if(!m)return;n(""),h(-1),f([]);const k=await V(m);if(k.output==="__CLEAR__"){p();return}const B={command:m,result:k,timestamp:Date.now()};o(B),b(),await l(),e==null||e()},[a,o,p,b,l,e]),N=d.useCallback(u=>{if(u.key==="Tab"){u.preventDefault();const m=Ee(a);if(m.length===1)n(m[0]),f([]);else if(m.length>1){f(m);const k=(x+1)%m.length;E(k),n(m[k])}return}if(u.key==="ArrowUp"){u.preventDefault();const m=R.map(B=>B.command);if(m.length===0)return;const k=i<m.length-1?i+1:i;h(k),n(m[m.length-1-k]);return}if(u.key==="ArrowDown"){if(u.preventDefault(),i<=0){h(-1),n("");return}const m=i-1;h(m);const k=R.map(B=>B.command);n(k[k.length-1-m]);return}c.length>0&&(f([]),E(0))},[a,R,i,c,x]),A=u=>{switch(u.type){case"success":return"text-arena-success";case"error":return"text-arena-error";case"warning":return"text-arena-warning";default:return"text-arena-textMuted"}};return g.jsxs("div",{className:"flex flex-col h-full bg-arena-bg border-t border-arena-border",onClick:$,role:"region","aria-label":"Terminal",children:[g.jsxs("div",{ref:r,className:"flex-1 overflow-y-auto px-2 py-1.5 font-mono text-sm space-y-0.5","aria-live":"polite","aria-atomic":"false",children:[R.length===0&&g.jsxs("div",{className:"text-arena-textDim py-1",children:["Welcome to GitArena! Type ",g.jsx("span",{className:"text-arena-accent",children:"help"})," for available commands."]}),R.map((u,m)=>g.jsxs("div",{className:"animate-fade-in",children:[g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("span",{className:"text-arena-accent select-none",children:"$"}),g.jsx("span",{className:"text-arena-text",children:u.command})]}),u.result.output&&g.jsx("pre",{className:`whitespace-pre-wrap pl-2 text-[13px] leading-relaxed ${A(u.result)}`,children:u.result.output})]},m))]}),g.jsxs("form",{onSubmit:w,className:"flex items-center px-2 py-1 border-t border-arena-border/50 bg-arena-surface/30",children:[g.jsx("span",{className:"text-arena-accent mr-1 select-none font-mono text-sm","aria-hidden":"true",children:"$"}),g.jsx("input",{ref:t,type:"text",value:a,onChange:u=>n(u.target.value),onKeyDown:N,className:"terminal-input",placeholder:"Type a git command...",autoComplete:"off",spellCheck:!1,"aria-label":"Git command input",autoFocus:!0})]}),c.length>1&&g.jsx("div",{className:"absolute bottom-[40px] left-2 bg-arena-surface border border-arena-border rounded-lg shadow-lg py-0.5 z-50 max-w-[300px]",role:"listbox","aria-label":"Autocomplete suggestions",children:c.map((u,m)=>g.jsx("div",{className:`px-2 py-0.5 text-sm font-mono cursor-pointer ${m===x?"bg-arena-accent/15 text-arena-accent":"text-arena-textMuted hover:bg-arena-surfaceHover"}`,role:"option","aria-selected":m===x,onClick:()=>{var k;n(u),f([]),(k=t.current)==null||k.focus()},children:u},u))})]})}),je=d.memo(function({onReset:e}){const t=y(re),r=y(ne),a=d.useCallback(async()=>{const n=pe();if(await n.init(),t){const f=ie(t);if(f)for(const x of f.setupCommands)await V(x,n)}const i=await n.allCommits(),h=await n.currentBranch(),c=await n.listBranches();y.getState().setCommits(i),y.getState().setCurrentBranch(h),y.getState().setBranches(c),y.getState().clearHistory(),y.getState().resetCommandCount(),y.getState().setLevelPassed(!1),e==null||e()},[t,e]);return g.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 border-b border-arena-border bg-arena-surface/50",children:[g.jsxs("button",{onClick:a,className:"btn-ghost text-xs flex items-center gap-0.5","aria-label":"Reset repository",children:[g.jsx("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true",children:g.jsx("path",{d:"M8 2.5a5.487 5.487 0 0 0-4.131 1.869l1.204 1.204A.25.25 0 0 1 4.896 6H1.25A.25.25 0 0 1 1 5.75V2.104a.25.25 0 0 1 .427-.177l1.38 1.38A7.001 7.001 0 0 1 15 8a.75.75 0 0 1-1.5 0A5.5 5.5 0 0 0 8 2.5zM1.75 8a.75.75 0 0 1 .75.75A5.5 5.5 0 0 0 8 13.5a5.487 5.487 0 0 0 4.131-1.869l-1.204-1.204A.25.25 0 0 1 11.104 10h3.646a.25.25 0 0 1 .25.25v3.646a.25.25 0 0 1-.427.177l-1.38-1.38A7.001 7.001 0 0 1 1 8.75.75.75 0 0 1 1.75 8z"})}),"Reset"]}),r&&g.jsxs("div",{className:"ml-auto flex items-center gap-1 text-arena-success text-sm font-medium animate-scale-in",children:[g.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true",children:g.jsx("path",{d:"M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16zm3.78-9.72a.751.751 0 0 0-1.042-1.08L6.833 9.262 5.207 7.636a.75.75 0 1 0-1.06 1.06l2.18 2.18a.75.75 0 0 0 1.062-.02L11.78 6.28z"})}),"Level Complete!"]})]})});export{je as C,Te as G,Me as T,V as e,q as g,pe as r};
